<!-- quiz_atp.html -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ATP ë¬¸ì œ í’€ê¸°</title>
  <script src="problems.js"></script> <!-- ë¬¸ì œ ìŠ¤í¬ë¦½íŠ¸ íŒŒì¼ ë¶ˆëŸ¬ì˜¤ê¸° -->
  <link rel="stylesheet" href="style.css"> <!-- í•„ìš”í•œ ê²½ìš° ìŠ¤íƒ€ì¼ -->
</head>
<body>
  <div class="quiz-container">
    <h1>ATP Random Question âœˆï¸</h1>
    <div id="score"></div>
    <div id="question">ë¬¸ì œ ë¡œë”© ì¤‘...</div>
    <div id="choices"></div>
    <div id="feedback"></div>
    <div id="answer" style="display: none;"></div>
    <button id="next-btn" onclick="nextQuestion()">ë‹¤ìŒ ë¬¸ì œ</button>
    <button onclick="location.href='index.html'">ë©”ì¸í˜ì´ì§€ë¡œ ëŒì•„ê°€ê¸°</button>
    <button onclick="location.href='wrongnote_atp.html'">ì˜¤ë‹µë…¸íŠ¸ í’€ê¸°</button>
  </div>

  <script>
    let problems = window.problems; // ë¬¸ì œ ë°ì´í„° ì‚¬ìš©
    let current = 0;
    let correctCount = 0;
    let totalCount = 0;
    let answered = false;
    let wrongProblems = [];

    function setupQuiz() {
      if (problems.length === 0) {
        document.getElementById('question').innerText = "í˜„ì¬ ë¬¸ì œê°€ ì—†ìŠµë‹ˆë‹¤.";
        return;
      }
      showProblem();
    }

    function showProblem() {
      if (current >= problems.length) {
        document.getElementById('question').innerHTML = "ğŸ‰ ëª¨ë“  ë¬¸ì œë¥¼ ë‹¤ í’€ì—ˆìŠµë‹ˆë‹¤!";
        document.getElementById('choices').innerHTML = "";
        document.getElementById('next-btn').style.display = 'none';
        return;
      }

      const problem = problems[current];
      document.getElementById('question').innerText = problem.question;

      const choicesDiv = document.getElementById('choices');
      choicesDiv.innerHTML = '';
      problem.choices.forEach(choice => {
        const btn = document.createElement('button');
        btn.innerText = choice;
        btn.onclick = () => checkAnswer(choice);
        choicesDiv.appendChild(btn);
      });

      document.getElementById('feedback').innerText = '';
      document.getElementById('answer').style.display = 'none';
    }

    function checkAnswer(selected) {
      if (answered) return;
      answered = true;
      totalCount++;

      const correctChoice = problems[current].choices.find(c => c.startsWith(problems[current].correct));
      if (selected.startsWith(problems[current].correct)) {
        correctCount++;
        document.getElementById('feedback').innerText = "ì •ë‹µì…ë‹ˆë‹¤! ğŸ‰";
        document.getElementById('feedback').style.color = 'green';
      } else {
        wrongProblems.push(problems[current]);
        document.getElementById('feedback').innerText = `ì˜¤ë‹µì…ë‹ˆë‹¤ ğŸ¤­ \nì •ë‹µì€: ${correctChoice}`;
        document.getElementById('feedback').style.color = 'red';
      }
      document.getElementById('answer').innerText = problems[current].explanation;
      document.getElementById('answer').style.display = 'block';
    }

    function nextQuestion() {
      answered = false;
      current++;
      showProblem();
    }

    setupQuiz();
  </script>
</body>
</html>
